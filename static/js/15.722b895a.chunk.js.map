{"version":3,"sources":["common/pages/waterfall/waterfall.js","webpack:///./src/common/pages/waterfall/index.less?c330","common/pages/waterfall/index.less","common/pages/waterfall/imgUrlList.js","common/pages/waterfall/index.js"],"names":["isLoading","eventEmitter","this","sub","Waterfall","options","arguments","length","undefined","call","opts","number","fixWidth","width","document","body","clientWidth","documentElement","container","resize","scrollElem","init","bind","prototype","on","eventName","func","push","emit","argsList","Array","slice","i","apply","Object","create","constructor","proto","compareOpts","self","keys","forEach","key","$waterfall","getElementById","style","imgList","getElementsByTagName","perNum","getPerNum","perList","offsetHeight","pointer","getMinPointer","position","left","offsetLeft","offsetWidth","top","singleImgWidth","Math","floor","parseInt","append","currentPosition","count","tmpObj","tmpArr","offsetTop","Number","util","addEventListener","window","bindScrollElem","scroll","unbind","removeEventListener","minHeight","min","done","getElementsByClassName","setAttribute","loadImg","loadContainer","createElement","appendChild","parentElem","scrollTop","clientHeight","elem","evName","content","__webpack_require__","module","transform","locals","exports","waterfall","loadImage","urlList","callback","completeCount","img","Image","src","complete","onload","_react2","default","Component","_imgUrlList2","setTimeout","id","map","r","index","className","alt"],"mappings":"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","file":"static/js/15.722b895a.chunk.js","sourcesContent":["(function () {\n  let isLoading = false\n\n  function eventEmitter() {\n    this.sub = {}\n  }\n\n  eventEmitter.prototype.on = function (eventName, func) {\n    if (this.sub[eventName]) { // 一种类型的事件只能绑定一个函数\n      return\n    }\n    if (!this.sub[eventName]) {\n      this.sub[eventName] = []\n    }\n    this.sub[eventName].push(func)\n  }\n\n  eventEmitter.prototype.emit = function (eventName) {\n    const argsList = Array.prototype.slice.call(arguments, 1)\n    for (let i = 0, length = this.sub[eventName].length; i < length; i++) {\n      this.sub[eventName][i].apply(this, argsList)\n    }\n  }\n\n  function Waterfall(options = {}) {\n    eventEmitter.call(this)\n    this.opts = {\n      number: options.number,\n      fixWidth: options.fixWidth || null,\n      width: `${options.width || document.body.clientWidth || document.documentElement.clientWidth}px`,\n      container: options.container || 'waterfall',\n      resize: false,\n      scrollElem: options.scrollElem,\n    }\n    this.init(options) // 这个 this 是 new 的时候，绑上去的\n    this.bind()\n  }\n\n  Waterfall.prototype = Object.create(eventEmitter.prototype)\n  Waterfall.prototype.constructor = Waterfall\n\n  const proto = Waterfall.prototype\n\n  proto.compareOpts = function (options) {\n    const self = this\n    Object.keys(options).forEach((key) => {\n      self.opts[key] = options[key]\n    })\n  }\n\n  proto.init = function (options) {\n    this.compareOpts(options)\n    const $waterfall = document.getElementById(this.opts.container)\n    $waterfall.style.width = `${this.opts.fixWidth || this.opts.width}px`\n    const imgList = $waterfall.getElementsByTagName('img')\n    if (this.opts.resize) {\n      this.resize(imgList)\n    }\n    const perNum = this.getPerNum()\n    const perList = [] // 存储第一列的各图片的高度\n    for (let i = 0; i < perNum; i++) {\n      perList.push(imgList[i].offsetHeight)\n    }\n\n    let pointer = this.getMinPointer(perList) || '0'\n\n    if (this.opts.fixWidth) {\n      for (let i = 0; i < perNum; i++) {\n        imgList[i].style.position = 'absolute'\n        imgList[i].style.left = `${imgList[0].offsetLeft + imgList[i].offsetWidth * i}px`\n      }\n    }\n\n    for (let i = perNum; i < imgList.length; i++) {\n      imgList[i].style.position = 'absolute' // 核心语句\n      imgList[i].style.left = `${imgList[pointer].offsetLeft}px`\n      imgList[i].style.top = `${perList[pointer]}px`\n\n      perList[pointer] = perList[pointer] + imgList[i].offsetHeight // 数组最小的值加上相应图片的高度\n      pointer = this.getMinPointer(perList)\n    }\n  }\n\n  proto.getPerNum = function () {\n    const $waterfall = document.getElementById(this.opts.container)\n    const imgList = $waterfall.getElementsByTagName('img')\n    const singleImgWidth = imgList[0].offsetWidth // 瀑布流默认每张图片宽度相等\n    return Math.floor(parseInt(this.opts.fixWidth || this.opts.width, 10) / singleImgWidth)\n  }\n\n  // 在 init 函数基础上的优化，触发 scroll 的时候，只对增加的部分渲染，这个函数想了比较久。大体思路首先找到最后一列的图片(注意不一定连续的)，并在高度最小的那个图片后面添加图片。\n  proto.append = function () {\n    const $waterfall = document.getElementById(this.opts.container)\n    const imgList = $waterfall.getElementsByTagName('img')\n    const length = imgList.length\n    const perNum = this.getPerNum()\n    const perList = [] // 存储最后一列的各图片的高度\n    const currentPosition = length - this.opts.number // 要添加图片的起始坐标, +1 -1 抵消掉\n    let count = 1\n    const tmpObj = {}\n    const tmpArr = [] // 存储 count 的值\n    while (count < 100) {\n      if (!tmpObj[imgList[currentPosition - count].offsetLeft] && tmpObj[imgList[currentPosition - count].offsetLeft] !== 0) {\n        tmpObj[imgList[currentPosition - count].offsetLeft] = imgList[currentPosition - count].offsetLeft\n        perList.push(imgList[currentPosition - count].offsetHeight + imgList[currentPosition - count].offsetTop)\n        tmpArr.push(count)\n        if (tmpArr.length === perNum) {\n          break\n        }\n      }\n      count++\n    }\n\n    let pointer = this.getMinPointer(perList) || 0\n\n    for (let i = 0; i < this.opts.number; i++) {\n      imgList[currentPosition + i].style.position = 'absolute'\n      imgList[currentPosition + i].style.left = `${imgList[currentPosition - tmpArr[Number(pointer)]].offsetLeft}px`\n      imgList[currentPosition + i].style.top = `${perList[pointer]}px`\n\n      perList[pointer] = perList[pointer] + imgList[currentPosition + i].offsetHeight // 数组最小的值加上相应图片的高度\n      pointer = this.getMinPointer(perList)\n    }\n  }\n\n  proto.bind = function () {\n    // 如果设置了 fixWidth 的长度，则没必要绑定 resize\n    if (!this.opts.fixWidth) {\n      util.addEventListener(window, 'resize', resize.bind(this))\n    }\n    const bindScrollElem = document.getElementById(this.opts.scrollElem)\n    util.addEventListener(bindScrollElem || window, 'scroll', scroll.bind(this))\n  }\n\n  // 解除对 scroll 的绑定\n  proto.unbind = function () {\n    const bindScrollElem = document.getElementById(this.opts.scrollElem)\n    util.removeEventListener(bindScrollElem || window, 'scroll', scroll.bind(this))\n  }\n\n  // 获取最小高度的数组下标\n  proto.getMinPointer = function (perList) {\n    const minHeight = Math.min.apply(null, perList)\n    for (let i in perList) {\n      if (perList[i] === minHeight) {\n        return i\n      }\n    }\n  }\n\n  // 重置 position: absolute 防止 onresize 的时候产生干扰\n  proto.resize = function (imgList) {\n    for (let i = 0; i < imgList.length; i++) {\n      imgList[i].style.position = 'static'\n    }\n    this.opts.resize = false\n  }\n\n  // 注册一次 done 事件，并触发\n  proto.done = function () {\n    const self = this\n    this.on('done', function () {\n      isLoading = false\n      // 取消加载按钮\n      const loadContainer = document.getElementsByClassName('waterfall-loading')[0]\n      loadContainer.setAttribute('class', '')\n      self.append()\n    })\n    this.emit('done')\n  }\n\n  // 添加加载动画\n  proto.loadImg = function () {\n    const $waterfall = document.getElementById(this.opts.container)\n    const loadContainer = document.createElement('div')\n    loadContainer.setAttribute('class', 'waterfall-loading')\n    $waterfall.appendChild(loadContainer)\n  }\n\n  const resize = function () {\n    // 这个 this 是 bind 上去的\n    this.init({\n      resize: true,\n      width: `${document.body.clientWidth || document.documentElement.clientWidth}px`,\n    })\n  }\n\n  const scroll = function () {\n    // 如果绑定在 window 上，\n    if (!this.opts.scrollElem) {\n      if (isLoading) return false // 避免一次触发事件多次\n      const $waterfall = document.getElementById(this.opts.container)\n      const imgList = $waterfall.getElementsByTagName('img')\n      const scrollPX = document.body.scrollTop || document.documentElement.scrollTop\n      const bsHeight = document.body.clientHeight || document.documentElement.clientHeight\n      if (scrollPX + bsHeight > imgList[imgList.length - 1].offsetTop) { // 浏览器高度 + 滚动距离 < 最后一张图片的 offsetTop\n        isLoading = true\n        this.loadImg()\n        this.emit('load')\n      }\n    } else { // scrollElem 绑定在其它节点上\n      if (isLoading) return false\n      const $waterfall = document.getElementById(this.opts.container)\n      if (!$waterfall) return false // 防止 React 中多次绑定\n      const imgList = $waterfall.getElementsByTagName('img')\n      const parentElem = document.getElementById(this.opts.scrollElem)\n      const scrollElemPX = parentElem.scrollTop\n      const parentElemHeight = parentElem.clientHeight\n      if (scrollElemPX + parentElemHeight > imgList[imgList.length - 1].offsetTop) {\n        isLoading = true\n        this.loadImg()\n        this.emit('load')\n      }\n    }\n  }\n\n  const util = {\n    addEventListener: function (elem, evName, func) {\n      elem.addEventListener(evName, func, false)\n    },\n    removeEventListener: function (elem, evName, func) {\n      elem.removeEventListener(evName, func, false)\n    },\n  }\n\n  window.Waterfall = Waterfall\n}())","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/postcss-loader/lib/index.js??postcss!../../../../node_modules/less-loader/dist/cjs.js??ref--4-oneOf-3-3!./index.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/postcss-loader/lib/index.js??postcss!../../../../node_modules/less-loader/dist/cjs.js??ref--4-oneOf-3-3!./index.less\", function() {\n\t\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js!../../../../node_modules/postcss-loader/lib/index.js??postcss!../../../../node_modules/less-loader/dist/cjs.js??ref--4-oneOf-3-3!./index.less\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"#waterfall {\\n  position: relative;\\n}\\n.waterfall-box {\\n  float: left;\\n  padding-left: 10px;\\n  padding-bottom: 10px;\\n  width: 200px;\\n  border-radius: 2px;\\n}\\n.waterfall-loading {\\n  position: fixed;\\n  top: 50%;\\n  left: 50%;\\n  margin-top: -25px;\\n  margin-left: -25px;\\n  width: 50px;\\n  height: 50px;\\n  border: 5px solid #eee;\\n  border-top: 5px solid #3aacd7;\\n  border-radius: 50%;\\n  -webkit-animation: 1s infinite linear loading;\\n          animation: 1s infinite linear loading;\\n}\\n@-webkit-keyframes loading {\\n  from {\\n    -webkit-transform: rotate(0deg);\\n            transform: rotate(0deg);\\n  }\\n  to {\\n    -webkit-transform: rotate(360deg);\\n            transform: rotate(360deg);\\n  }\\n}\\n@keyframes loading {\\n  from {\\n    -webkit-transform: rotate(0deg);\\n            transform: rotate(0deg);\\n  }\\n  to {\\n    -webkit-transform: rotate(360deg);\\n            transform: rotate(360deg);\\n  }\\n}\\n\", \"\"]);\n\n// exports\n","const imgUrlList = [\n  'http://img.hb.aicdn.com/1cad414972c5db2b8c1942289e3aeef37175006a8bb16-CBtjtX_fw',\n  'http://img.hb.aicdn.com/016f2e13934397e17c3482a4529f3da1149d37fd2a99c-RVM1Gi_fw',\n  'http://img.hb.aicdn.com/8c5d5f2bf6427d1b5ed8657a7ae0c9938d3465e367899-AJ0zVA_fw',\n  'http://img.hb.aicdn.com/bd71ccac0b16bbcade255a1a8a63504d71c7dee9a8652-zBCN9d_fw',\n  'http://img.hb.aicdn.com/37a40cb04345463858d45418ae6ed9ef319e30dc37a45-o4pQ0j_fw',\n  'http://img.hb.aicdn.com/5fad6c3a14a9b80c4448835bb6b23ab895d18e234eff3-BPGmox_fw',\n  'http://img.hb.aicdn.com/a1a19de5dac212a646ba6967ef565786399fb1665bd04-EEvwzR_fw',\n  'http://img.hb.aicdn.com/06595f8044e881de3a82d691768bc8c21a2a9f3633d60-XKjC2s_fw',\n  'http://img.hb.aicdn.com/880787b36d45efbe05aa409c867db29a3028e02da7f9b-qxGib9_fw',\n  'http://img.hb.aicdn.com/4964b97f6f6eb61a20922b40842adf0169c44e491c4b60-azX1S7_fw',\n  'http://img.hb.aicdn.com/ff97d00944edfc706c62dd5c0e955c4099a37b407534f-BcUqf0_fw',\n  'http://img.hb.aicdn.com/0e22be22b08c6f78b94283b6cfa890093ac3cae8401e7-b1ftfi_fw',\n  'http://img.hb.aicdn.com/879f870e15f7cc0847c8ae19a5fcbe974d5904bb181d7-RGmtNU_fw',\n  'http://img.hb.aicdn.com/b4a8e62958555a97dc3de9ccb03284bf556c042925522-x50qGv_fw',\n  'http://img.hb.aicdn.com/1ef493a15674e9fd523b248ea4ec43d2ea9ce6952ff3e-WavWKc_fw',\n  'http://img.hb.aicdn.com/8e16efec78ac4a3684fc8999d18e3661af40fd4510a25-DDvQON_fw',\n  'http://img.hb.aicdn.com/61dfa024c8040e6a5bcb03d42928fbcb0c87c1a54e731-yc4lvV_fw',\n  'http://img.hb.aicdn.com/6783b4d7811ad7fb87b1446c5488b91179f7608118289-hpEyP3_fw',\n  'http://img.hb.aicdn.com/7be61ba6bdb20a73be63edc387b16eec72d0bbb51c7ef-XafA07_fw',\n  'http://img.hb.aicdn.com/bd3ba3f907fe098b911947e0020615b50fc340ed2df72-WsuHuM_fw',\n  'http://img.hb.aicdn.com/71471aaac95eade66400a390863b37c76d9addcd14982-0H6sak_fw',\n  'http://img.hb.aicdn.com/cb16c68c4d3b7a08b5e91cd351f6b723634ca3fc27d4d-m1JD8z_fw',\n  'http://img.hb.aicdn.com/e3559b6e8d7237857382050e5659a64cc0b7d696a2869-stcRXA_fw',\n  'http://img.hb.aicdn.com/4ea229436fcf2077502953907a6afb16d3c5cd611b8e2-0dVIeH_fw',\n  'http://img.hb.aicdn.com/98c786f4314736f95a42bf927bf65a82d305a532c6258-njI6id_fw'\n]\n\nexport default imgUrlList\n","import React from 'react'\nimport './waterfall.js'\nimport './index.less'\nimport imgUrlList from './imgUrlList'\n\nlet waterfall = null\n\nexport default class Waterfall extends React.Component {\n  componentDidMount() {\n    function wf() {\n      waterfall = new window.Waterfall({\n        number: 20,\n        fixWidth: 1000,\n        scrollElem: 'content',\n      })\n      waterfall.on('load', () => {\n        setTimeout(() => {\n          const $waterfall = document.getElementById('waterfall')\n          for (let i = 0; i < 20; i++) {\n            const img = document.createElement('img')\n            img.setAttribute('src', imgUrlList[i])\n            img.setAttribute('class', 'waterfall-box')\n            $waterfall.appendChild(img)\n          }\n          waterfall.done()\n        }, 1000)\n      })\n    }\n    this.loadImage(imgUrlList, wf)\n  }\n\n  componentWillUnmount() {\n    waterfall = null\n  }\n\n  // 实现图片预加载\n  loadImage = (urlList, callback) => {\n    let count = 0\n    let completeCount = 0\n    for (let i = 0; i < urlList.length; i++) {\n      const img = new Image() //创建一个Image对象，实现图片的预下载\n      img.src = urlList[i]\n      if (img.complete) {\n        completeCount++\n      } else {\n        // eslint-disable-next-line\n        img.onload = () => {\n          count++\n          if (count === urlList.length) {\n            callback()\n          }\n        }\n      }\n    }\n    if (completeCount === urlList.length) {\n      callback()\n    }\n  }\n\n  render() {\n    return (\n      <div id=\"waterfall\">\n        {imgUrlList.map((r, index) => <img key={index} src={r} className=\"waterfall-box\" alt=\"waterfall\" />)}\n      </div>\n    )\n  }\n}"],"sourceRoot":""}